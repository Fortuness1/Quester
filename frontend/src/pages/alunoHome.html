<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/frontend/src/styles/alunoHome.css" />
    <title>Home</title>
  </head>
  <body>
    <nav class="sidebar">
      <ul>
        <li class="sidebar-item">
          <a href="alunoHome.html">
          <img src="/frontend/assets/img/lupaQuester.svg" alt="" />
          </a>
        </li>
        <li class="sidebar-item menu">
          <a href="criarPartida.html">
            <img src="/frontend/assets/icon/Play.svg" alt="Play" />
          </a>
        </li>
        <li class="sidebar-item menu">
          <a href="partidasGuardadas.html">
            <img src="/frontend/assets/icon/Grid.svg" alt="Partidas Guardadas" />
          </a>
        </li>
        <li class="sidebar-item menu">
          <a href="testeCriarQuestao.html">
            <img
              src="/frontend/assets/icon/Text Bullet List Square.svg"
              alt="Lista de Questões"
            />
          </a>
        </li>
        <li class="sidebar-item menu">
          <!-- <a href="historico.html"> -->
            <img src="/frontend/assets/icon/Document Copy.svg" alt="Historico de Partidas" />
          <!-- </a> -->
        </li>
      </ul>
      <ul>
        <li class="user-option">
          <a href="profile.html">
            <img src="/frontend/assets/icon/person-circle.svg" alt="Profile" />
          </a>
        </li>
        <li class="user-option">
          <a href="logout.html">
            <img src="/frontend/assets/icon/Arrow Exit.svg" alt="Logout" />
          </a>
        </li>
      </ul>
    </nav>

    <main>
      <h1 class="title">Início</h1>
      <div class="mascot-container container-settings">
        <div class="mascot-image">[Mascote e frase de efeito]</div>
      </div>
      <div class="match-section container-settings">
        <h2>Bem-vindo, <span id="userName"></span>!</h2>
        <div class="input-box">
          <form action="">
            <input type="text" name="pin" id="pin" placeholder="PIN" required />
          </form>
        </div>

        <h3 class="button-menu">Entrar</h3>
      </div>
    </main>
    <script>
      document.addEventListener("DOMContentLoaded", async function () {
        const userId = localStorage.getItem("userId");
        const occupation = localStorage.getItem("occupation");

        if (userId && occupation) {
          try {
            // Fazer uma requisição para buscar as informações do usuário pelo userId
            const response = await fetch("http://localhost:3000/user", {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify({ _id: userId }),
            });

            if (response.ok) {
              const userData = await response.json();
              // Exibir as informações do usuário na tela
              document.getElementById(
                "userName"
              ).textContent = `${userData.surname}`;
            } else {
              // Se o usuário não for encontrado ou ocorrer um erro, redirecionar para a página de login
              window.location.href = "login.html";
            }
          } catch (error) {
            console.error("Erro ao buscar informações do usuário:", error);
            window.location.href = "login.html"; // Redireciona em caso de erro
          }
        } else {
          // Redireciona para a página de login se não houver informações no localStorage
          window.location.href = "login.html";
        }
      });
    </script>
  </body>
</html>
