<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Exemplo de Posição no Array</title>
</head>
<body>
    <form>
        <input type="text" name="email" id="email" placeholder="email">
        <input type="text" name="email" id="senha" placeholder="senha">
        <input type="submit" value="Enviar">
    </form>
    <p>
        Seu ID é: <span id="id-div"></span>
    </p>
    <p>
        Seu Nome é: <span id="name-div"></span>
    </p>
    <p>
        Sua senha é: <span id="senha-div"></span>
    </p>
    <p>
        Seu email é: <span id="email-div"></span>
    </p>
    <p>
        Sua coisa preferida é: <span id="coisa-preferida-div"></span>
    </p>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
        var id = sessionStorage.getItem("quester_idUser");
            if(id == null){
                alert("null");  window.location = "./index.html"; 
            } else { 
                alert(id);
                var go = vai(id).then((data) => {
                    console.log(data);
                    document.getElementById("name-div").textContent = data.name;
                    document.getElementById("id-div").textContent = data._id;
                    console.log(data.name);
                    document.getElementById("email-div").textContent = data.email;
                    document.getElementById("senha-div").textContent = data.password;
                    document.getElementById("coisa-preferida-div").textContent = data.coisa_preferida;
                });
            }
        });
        

        const vai = async (id) => {
            const url = `http://localhost:3001/findbyid/${id}`;
            
            try {
                const response = await fetch(url, {
                    method: 'GET'
                });

                if (!response.ok) {
                    throw new Error(`Response status: ${response.status}`);
                }

                const json = await response.json();
                console.log(json);
                return await { _id: json._id, name: json.nome ,email: json.email, password: json.password, coisa_preferida: json.coisa_preferida};
            }catch (error) {
                console.error(error.message + "erro catch");
            }
        }
    </script>
</body>
</html>
